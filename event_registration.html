<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Event Registration</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    .form-container {
      max-width: 800px;
      margin: auto;
    }
    iframe {
      width: 100%;
      height: 1200px;
      border: none;
    }
    .calculator {
      margin-bottom: 20px;
      padding: 15px;
      border: 1px solid #ccc;
      border-radius: 5px;
      background-color: #f9f9f9;
    }
    .calculator label {
      display: block;
      margin-bottom: 10px;
    }
    .calculator input {
      width: 100%;
      padding: 10px;
      margin-bottom: 15px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    .total {
      font-weight: bold;
      font-size: 1.2em;
    }
  </style>
</head>
  

  <!--action="https://docs.google.com/forms/u/0/d/e/1FAIpQLScJx4zB1uZNIlGHUG4fJ5-amtI7Ie-YL9FCY7JaT5NtU5trfg/formResponse"-->
  <!--action="https://docs.google.com/forms/d/1Hj9XlnPqFrnXn9h_88SGK556QpPxsIDlym3oEBGcBnY/prefill"-->
<body>
  <form
  action="https://docs.google.com/forms/d/e/1FAIpQLScJx4zB1uZNIlGHUG4fJ5-amtI7Ie-YL9FCY7JaT5NtU5trfg/viewform?usp=pp_url&"
  method="POST"
  name="prefill"
  onsubmit="return OnSubmitForm();">
  <!-- target="iframe">  -->
  <label for="成人人數 (12 歲或以上)*">成人人數 (12 歲或以上)*:</label>
  <input type="number" name="entry.1607513178" id="adults" required>

  <label for="兒童(4 至11 歲) 人數*">兒童(4 至11 歲) 人數*:</label>
  <input type="number" name="entry.523040310" id="children" required>

  <label for="兒童(4 歲以下) 人數*">兒童(4 歲以下) 人數*:</label>
  <input type="number" name="entry.308155383" id="infants" required>

  <label for="參加類別">參加類別:</label>
  <input type="text" name="entry.1109016814" id="duration" required>
    
  <label for="住宿安排">住宿安排:*</label>
  <input type="text" name="entry.438181447" id="accomodation" required>

 <label for="Townhouse 數目">Townhouse 數目:*</label>
  <input type="number" name="entry.307969292" id="accomodation">

  <button type="submit">Get Form Url</button>
</form>

<!-- Embed the Google Form in an iframe for users to verify their inputs 
<iframe
  src="https://docs.google.com/forms/d/e/1FAIpQLScJx4zB1uZNIlGHUG4fJ5-amtI7Ie-YL9FCY7JaT5NtU5trfg/viewform"
  width="100%"
  height="800"
  frameborder="0">
</iframe>
-->
  <div class="form-container">
    <div class="calculator">
      <h3>Fee Calculator</h3>
      <label for="num-participants">Number of Participants:</label>
      <input type="number" id="num-participants" placeholder="Enter number of participants" min="1">

      <label for="num-nights">Number of Nights (Hotel):</label>
      <input type="number" id="num-nights" placeholder="Enter number of nights" min="1">

      <label for="num-days">Number of Days (Meals):</label>
      <input type="number" id="num-days" placeholder="Enter number of days" min="1">

      <p class="total">Total Fee: $<span id="total-fee">0</span></p>
    </div>

    <iframe
      src="https://docs.google.com/forms/d/e/1FAIpQLScJx4zB1uZNIlGHUG4fJ5-amtI7Ie-YL9FCY7JaT5NtU5trfg/viewform?usp=dialog"
      title="Event Registration Form">
    </iframe>
  </div>

  <script>
    //src="https://docs.google.com/forms/d/e/1FAIpQLScJx4zB1uZNIlGHUG4fJ5-amtI7Ie-YL9FCY7JaT5NtU5trfg/viewform?usp=dialog"
     //src="https://docs.google.com/forms/d/e/1FAIpQLScJx4zB1uZNIlGHUG4fJ5-amtI7Ie-YL9FCY7JaT5NtU5trfg/viewform?usp=sharing"
    const hotelPrice = 100; // Price per person per night
    const mealPrice = 50; // Price per person per day

    // Elements
    const numParticipantsInput = document.getElementById('entry.1607513178');
    //const numParticipantsInput = document.getElementById('wSDd7b');
    
  //  const numParticipantsInput = document.getElementById('num-participants');
    const numNightsInput = document.getElementById('entry.523040310');
   // const numNightsInput = document.getElementById('num-nights');
    const numDaysInput = document.getElementById('entry.308155383');
   // const numDaysInput = document.getElementById('num-days');
    const totalFeeElement = document.getElementById('total-fee');

    console.log("numParticipantsInput: ", numParticipantsInput);
    // Calculate total fee
    function calculateTotalFee() {
      const numParticipants = parseInt(numParticipantsInput.value) || 0;
      const numNights = parseInt(numNightsInput.value) || 0;
      const numDays = parseInt(numDaysInput.value) || 0;

      const totalFee = (numParticipants * numNights * hotelPrice) + (numParticipants * numDays * mealPrice);
      totalFeeElement.textContent = totalFee.toFixed(2); // Display the total fee
    }

    // Add event listeners
    numParticipantsInput.addEventListener('input', calculateTotalFee);
    numNightsInput.addEventListener('input', calculateTotalFee);
    numDaysInput.addEventListener('input', calculateTotalFee);
  </script>

  <script type="text/javascript">
  function OnSubmitForm()
    {
      const adults = document.getElementById("adults").value;
      const children = document.getElementById("children").value;
      const infants = document.getElementById("infants").value;
      const duration = document.getElementById("duration").value;
      const accomodation = document.getElementById("accomodation").value;

  // Construct the action URL dynamically
      const baseUrl = "https://docs.google.com/forms/d/e/1FAIpQLScJx4zB1uZNIlGHUG4fJ5-amtI7Ie-YL9FCY7JaT5NtU5trfg/viewform";
      const queryParams = `?usp=pp_url&entry.1607513178=${encodeURIComponent(adults)}&entry.523040310=${encodeURIComponent(children)}&entry.308155383=${encodeURIComponent(infants)}&entry.1109016814=${encodeURIComponent(duration)}&entry.438181447=${encodeURIComponent(accomodation)}`;
  
  // Update the form action
  document.prefill.action = baseUrl + queryParams;

  // Return true to allow the form submission
  return true;
        
        
    }
</script>

</body>
</html>

